<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>My Classes</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet">
  <style>
    .sidebar {
      height: 100vh;
      background-color: #343a40;
      display: flex;
      flex-direction: column;
    }
    .sidebar a, .logout-form button {
      color: white;
      display: block;
      padding: 0.75rem 1rem;
      text-decoration: none;
      border: none;
      background: none;
      text-align: left;
      width: 100%;
    }
    .sidebar a:hover, .logout-form button:hover {
      background-color: #495057;
    }
    .sidebar a.active {
      background-color: #495057;
      font-weight: bold;
    }
    .logout-form {
      margin-top: auto;
      padding: 0.75rem 1rem;
    }
  </style>
</head>
<body>
<div class="container-fluid">
  <div class="row">
    <!-- Sidebar -->
    <nav class="col-md-2 sidebar p-0">
      <div class="p-3 text-white">
        <h4>Professor Panel</h4>
        <p th:text="'Logged in as: ' + ${#authentication.name}">professor</p>
      </div>
      <a href="/professor/dashboard" class="nav-link"><i class="fas fa-home me-2"></i>Dashboard</a>
      <a href="/professor/schedules" class="nav-link active"><i class="fas fa-calendar-alt me-2"></i>My Classes and Schedules</a>
      <a href="/professor/calendar" class="nav-link"><i class="fas fa-chart-line me-2"></i>Academic Calendar</a>
      <form th:action="@{/auth/logout}" method="post" class="logout-form mt-auto">
        <button type="submit"><i class="fas fa-sign-out-alt me-2"></i>Logout</button>
      </form>
    </nav>

    <!-- Main Content -->
    <main class="col-md-10 p-4">
      <h2 class="mb-4">My Classes</h2>

      <!-- Table of classes -->
      <div class="card">
        <div class="card-header">
          <h5 class="card-title mb-0"><i class="fas fa-chalkboard-teacher me-2"></i>Assigned Classes</h5>
        </div>
        <div class="card-body">
          <table class="table table-striped">
            <thead>
            <tr>
              <th>Course Code</th>
              <th>Course Title</th>
              <th>Schedule</th>
              <th>Actions</th>
            </tr>
            </thead>
            <tbody>
            <tr th:each="cls : ${classes}">
              <td th:text="${cls.courseCode}">CS101</td>
              <td th:text="${cls.courseTitle}">Intro to Programming</td>
              <td th:text="${cls.schedule}">Mon & Wed 10:00-11:30</td>
              <td>
                <!-- Button to open class details -->
                <a th:href="@{'/professor/classes/' + ${cls.id}}" class="btn btn-primary btn-sm">
                  <i class="fas fa-folder-open me-1"></i> Open
                </a>
              </td>
            </tr>
            </tbody>
          </table>
        </div>
      </div>

      <!-- Class Details Section -->
      <div th:if="${selectedClass != null}" class="mt-5">
        <div class="card">
          <div class="card-header">
            <h5>
              <i class="fas fa-book me-2"></i>
              <span th:text="${selectedClass.courseTitle}">Selected Class</span> - Upload Lesson
            </h5>
          </div>
          <div class="card-body">
            <!-- Upload lesson file -->
            <form th:action="@{'/professor/classes/' + ${selectedClass.id} + '/upload'}"
                  method="post"
                  enctype="multipart/form-data">
              <div class="mb-3">
                <label for="lessonFile" class="form-label">Upload Lesson File</label>
                <input type="file" class="form-control" id="lessonFile" name="file" required>
              </div>
              <button type="submit" class="btn btn-success">
                <i class="fas fa-upload me-1"></i> Upload
              </button>
            </form>

            <!-- List of uploaded lessons -->
            <hr>
            <h6>Uploaded Lessons</h6>
            <ul class="list-group">
              <li th:each="lesson : ${lessons}" class="list-group-item d-flex justify-content-between align-items-center">
                <a th:href="@{'/professor/classes/' + ${selectedClass.id} + '/lessons/' + ${lesson.id}}"
                   th:text="${lesson.fileName}">Lesson File</a>
                <span class="badge bg-secondary" th:text="${#temporals.format(lesson.uploadedAt, 'yyyy-MM-dd HH:mm')}">2025-08-23</span>
              </li>
              <li th:if="${lessons == null or #lists.isEmpty(lessons)}" class="list-group-item">
                No lessons uploaded yet.
              </li>
            </ul>
          </div>
        </div>
      </div>

    </main>
  </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
