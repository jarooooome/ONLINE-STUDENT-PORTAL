<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="en">
<head>
  <meta charset="UTF-8">
  <title>View Tuition Record</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
</head>
<body class="bg-light">
<div class="container py-4">
  <div class="d-flex justify-content-between align-items-center">
    <h2>Tuition Record</h2>
    <a th:href="@{/cashier/dashboard}" class="btn btn-secondary">Back</a>
  </div>

  <div class="card mt-3">
    <div class="card-body">
      <h5 class="card-title" th:text="${record.student.firstName + ' ' + record.student.lastName}">Student Name</h5>
      <p class="mb-1"><strong>Semester:</strong> <span th:text="${record.semester}">-</span></p>
      <p class="mb-1"><strong>Total Tuition:</strong>
        <span th:text="${#numbers.formatDecimal(record.totalTuition, 1, 'COMMA', 2, 'POINT')}">0.00</span></p>
      <p class="mb-1"><strong>Amount Paid:</strong>
        <span th:text="${#numbers.formatDecimal(record.amountPaid, 1, 'COMMA', 2, 'POINT')}">0.00</span></p>
      <p class="mb-1"><strong>Balance:</strong>
        <span th:text="${#numbers.formatDecimal(record.balance, 1, 'COMMA', 2, 'POINT')}">0.00</span></p>
      <p class="text-muted"><small>Last Updated: <span th:text="${#temporals.format(record.lastUpdated, 'yyyy-MM-dd HH:mm')}">-</span></small></p>
    </div>
  </div>

  <div class="card mt-3">
    <div class="card-header">Record Adjustment / Payment Entry (DB-only)</div>
    <div class="card-body">
      <form th:action="@{/cashier/update-payment/{id}(id=${record.id})}" method="post" class="row g-3">
        <div class="col-md-4">
          <label class="form-label">Amount</label>
          <input type="number" step="0.01" name="amount" class="form-control" required>
        </div>
        <div class="col-md-8">
          <label class="form-label">Remarks</label>
          <input type="text" name="remarks" class="form-control" placeholder="e.g., Manual adjustment / OR#" required>
        </div>
        <div class="col-12">
          <button class="btn btn-success" type="submit">Record Entry</button>
        </div>
      </form>
      <p class="text-muted mt-2 mb-0">This does NOT process real payments; it only records an internal entry and updates the balance.</p>
    </div>
  </div>

  <div class="card mt-3">
    <div class="card-header">Transaction Log</div>
    <div class="card-body table-responsive">
      <table class="table table-striped">
        <thead>
        <tr>
          <th>Date</th>
          <th>Amount</th>
          <th>Remarks</th>
        </tr>
        </thead>
        <tbody>
        <tr th:each="tx : ${transactions}">
          <td th:text="${#temporals.format(tx.transactionDate, 'yyyy-MM-dd HH:mm')}">-</td>
          <td th:text="${#numbers.formatDecimal(tx.paymentAmount, 1, 'COMMA', 2, 'POINT')}">0.00</td>
          <td th:text="${tx.remarks}">-</td>
        </tr>
        <tr th:if="${#lists.isEmpty(transactions)}">
          <td colspan="3" class="text-muted">No transactions yet.</td>
        </tr>
        </tbody>
      </table>
    </div>
  </div>

</div>
</body>
</html>
